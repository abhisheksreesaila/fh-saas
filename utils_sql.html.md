# ğŸ—ƒï¸ SQL Helpers


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## ğŸ¯ Overview

This module provides a **batteries-included SQL toolkit** for building
database-heavy applications:

<table>
<colgroup>
<col style="width: 34%" />
<col style="width: 37%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr>
<th>Category</th>
<th>Functions</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>ğŸ” Query Registry</td>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#run_id"><code>run_id</code></a>,
<a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#validate_params"><code>validate_params</code></a></td>
<td>Execute queries by ID from centralized registries</td>
</tr>
<tr>
<td>â• Insert-Only</td>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#insert_only"><code>insert_only</code></a>,
<a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#bulk_insert_only"><code>bulk_insert_only</code></a></td>
<td>Insert new records, skip conflicts</td>
</tr>
<tr>
<td>ğŸ”„ Upsert</td>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#upsert"><code>upsert</code></a>,
<a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#bulk_upsert"><code>bulk_upsert</code></a></td>
<td>Insert or update existing records</td>
</tr>
<tr>
<td>ğŸ“ CRUD</td>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#get_by_id"><code>get_by_id</code></a>,
<a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#update_record"><code>update_record</code></a>,
<a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#delete_record"><code>delete_record</code></a>,
<a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#bulk_delete"><code>bulk_delete</code></a></td>
<td>Standard database operations</td>
</tr>
<tr>
<td>ğŸ”§ Utilities</td>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#with_transaction"><code>with_transaction</code></a>,
<a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#paginate_sql"><code>paginate_sql</code></a>,
<a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#batch_execute"><code>batch_execute</code></a></td>
<td>Transaction management &amp; helpers</td>
</tr>
<tr>
<td>ğŸ’° Money</td>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#to_cents"><code>to_cents</code></a>,
<a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#from_cents"><code>from_cents</code></a></td>
<td>Currency conversion for <code>int</code>-only storage</td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

## ğŸ—ï¸ Architecture

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                     SQL Utilities Layer                         â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚  ğŸ” Query Registry        â”‚  Execute queries by ID              â”‚
    â”‚  â• Insert Operations     â”‚  insert_only, bulk_insert_only      â”‚
    â”‚  ğŸ”„ Upsert Operations     â”‚  upsert, bulk_upsert                â”‚
    â”‚  ğŸ“ CRUD Operations       â”‚  get, update, delete (single/bulk)  â”‚
    â”‚  ğŸ”§ Utilities             â”‚  transactions, pagination, batching â”‚
    â”‚  ğŸ’° Money Helpers         â”‚  cents â†” dollars conversion         â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚  DB_TYPE Detection: PostgreSQL / SQLite (auto-switch syntax)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              fastsql Database Connection                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

------------------------------------------------------------------------

## ğŸ“š Quick Reference

### Conflict Handling

<table>
<colgroup>
<col style="width: 32%" />
<col style="width: 38%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr>
<th>Operation</th>
<th>On Conflict</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#insert_only"><code>insert_only</code></a></td>
<td><strong>Skip</strong> (DO NOTHING)</td>
<td>Append-only logs, idempotent imports</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#upsert"><code>upsert</code></a></td>
<td><strong>Update</strong> existing</td>
<td>Sync external data, refresh caches</td>
</tr>
</tbody>
</table>

### Performance Tips

<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 46%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr>
<th>Scenario</th>
<th>Recommended</th>
<th>Why</th>
</tr>
</thead>
<tbody>
<tr>
<td>Single record</td>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#insert_only"><code>insert_only</code></a>,
<a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#upsert"><code>upsert</code></a></td>
<td>Simple, immediate</td>
</tr>
<tr>
<td>10+ records</td>
<td><code>bulk_*</code> variants</td>
<td>10-100x faster</td>
</tr>
<tr>
<td>100+ records</td>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#batch_execute"><code>batch_execute</code></a></td>
<td>Commits per batch, memory-safe</td>
</tr>
<tr>
<td>Multi-table changes</td>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#with_transaction"><code>with_transaction</code></a></td>
<td>All-or-nothing commits</td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

## ğŸ” Database Type Detection

Automatically detects PostgreSQL vs SQLite from `DB_TYPE` environment
variable to generate appropriate SQL syntax.

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L24"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_db_type

``` python

def get_db_type(
    
):

```

*Get database type from environment variable*

------------------------------------------------------------------------

## ğŸ¯ Query Registry

Execute queries by ID from a centralized registry with automatic
parameter validation.

<table>
<colgroup>
<col style="width: 55%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#run_id"><code>run_id</code></a></td>
<td>Execute a registered query by its ID</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#validate_params"><code>validate_params</code></a></td>
<td>Ensure all <code>:param</code> placeholders have values</td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L42"
target="_blank" style="float:right; font-size:smaller">source</a>

### run_id

``` python

def run_id(
    db:Database, registry:Dict, query_id:str, params:Optional=None
)->Any:

```

*Execute a query by ID from a query registry.*

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L33"
target="_blank" style="float:right; font-size:smaller">source</a>

### validate_params

``` python

def validate_params(
    sql:str, params:Dict
)->None:

```

*Validate that all required parameters are provided*

------------------------------------------------------------------------

## â• Insert-Only

Insert new records **only if they donâ€™t exist** â€” conflicts are silently
skipped.

<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 26%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr>
<th>Function</th>
<th>Records</th>
<th>SQL Generated</th>
</tr>
</thead>
<tbody>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#insert_only"><code>insert_only</code></a></td>
<td>Single</td>
<td><code>ON CONFLICT DO NOTHING</code> (PG) /
<code>INSERT OR IGNORE</code> (SQLite)</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#bulk_insert_only"><code>bulk_insert_only</code></a></td>
<td>Multiple</td>
<td>Same, with batch execution</td>
</tr>
</tbody>
</table>

> ğŸ’¡ **Use case**: Idempotent imports, append-only audit logs, webhook
> deduplication

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L95"
target="_blank" style="float:right; font-size:smaller">source</a>

### bulk_insert_only

``` python

def bulk_insert_only(
    db:Database, table_name:str, records:List, conflict_cols:List, auto_commit:bool=True
)->None:

```

*Insert multiple records, skipping conflicts (optimized batch
operation).*

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L64"
target="_blank" style="float:right; font-size:smaller">source</a>

### insert_only

``` python

def insert_only(
    db:Database, table_name:str, record:Dict, conflict_cols:List, auto_commit:bool=True
)->None:

```

*Insert a single record only if it doesnâ€™t exist (ignores conflicts).*

------------------------------------------------------------------------

## ğŸ”„ Upsert

Insert new records **or update existing ones** on conflict.

<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 26%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr>
<th>Function</th>
<th>Records</th>
<th>SQL Generated</th>
</tr>
</thead>
<tbody>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#upsert"><code>upsert</code></a></td>
<td>Single</td>
<td><code>ON CONFLICT DO UPDATE</code> (PG) /
<code>INSERT OR REPLACE</code> (SQLite)</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#bulk_upsert"><code>bulk_upsert</code></a></td>
<td>Multiple</td>
<td>Same, with batch execution</td>
</tr>
</tbody>
</table>

> ğŸ’¡ **Use case**: Syncing external API data, refreshing caches, user
> settings

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L166"
target="_blank" style="float:right; font-size:smaller">source</a>

### bulk_upsert

``` python

def bulk_upsert(
    db:Database, table_name:str, records:List, conflict_cols:List, update_cols:Optional=None, auto_commit:bool=True
)->None:

```

*Insert or update multiple records (optimized batch operation).*

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L129"
target="_blank" style="float:right; font-size:smaller">source</a>

### upsert

``` python

def upsert(
    db:Database, table_name:str, record:Dict, conflict_cols:List, update_cols:Optional=None, auto_commit:bool=True
)->None:

```

*Insert a record or update if it exists (upsert).*

------------------------------------------------------------------------

## ğŸ“ CRUD

Standard Create, Read, Update, Delete operations.

<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 32%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr>
<th>Function</th>
<th>Operation</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#get_by_id"><code>get_by_id</code></a></td>
<td><strong>Read</strong></td>
<td>Fetch single record by primary key</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#update_record"><code>update_record</code></a></td>
<td><strong>Update</strong></td>
<td>Modify record fields by ID</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#delete_record"><code>delete_record</code></a></td>
<td><strong>Delete</strong></td>
<td>Remove single record by ID</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#bulk_delete"><code>bulk_delete</code></a></td>
<td><strong>Delete</strong></td>
<td>Remove multiple records by ID list</td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L251"
target="_blank" style="float:right; font-size:smaller">source</a>

### bulk_delete

``` python

def bulk_delete(
    db:Database, table_name:str, id_list:List, id_col:str='id', auto_commit:bool=True
)->None:

```

*Delete multiple records by ID list.*

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L237"
target="_blank" style="float:right; font-size:smaller">source</a>

### delete_record

``` python

def delete_record(
    db:Database, table_name:str, id_value:Any, id_col:str='id', auto_commit:bool=True
)->None:

```

*Delete a single record by ID.*

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L216"
target="_blank" style="float:right; font-size:smaller">source</a>

### update_record

``` python

def update_record(
    db:Database, table_name:str, id_value:Any, id_col:str='id', auto_commit:bool=True, updates:VAR_KEYWORD
)->None:

```

*Update a single record by ID.*

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L206"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_by_id

``` python

def get_by_id(
    db:Database, table_name:str, id_value:Any, id_col:str='id'
)->Any:

```

*Get a single record by ID.*

------------------------------------------------------------------------

## ğŸ”§ Utilities

Transaction management, pagination, and batch processing.

<table>
<colgroup>
<col style="width: 55%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#with_transaction"><code>with_transaction</code></a></td>
<td>Context manager for atomic operations</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#paginate_sql"><code>paginate_sql</code></a></td>
<td>Add LIMIT/OFFSET to queries</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#batch_execute"><code>batch_execute</code></a></td>
<td>Process large lists in memory-safe chunks</td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L289"
target="_blank" style="float:right; font-size:smaller">source</a>

### batch_execute

``` python

def batch_execute(
    db:Database, operation_func, items:List, batch_size:int=100
)->None:

```

*Execute an operation on items in batches with commits after each
batch.*

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L284"
target="_blank" style="float:right; font-size:smaller">source</a>

### paginate_sql

``` python

def paginate_sql(
    sql:str, page:int, page_size:int
)->str:

```

*Add LIMIT/OFFSET pagination to a SQL query.*

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L275"
target="_blank" style="float:right; font-size:smaller">source</a>

### with_transaction

``` python

def with_transaction(
    db:Database
):

```

*Context manager for safe transaction handling with auto-rollback on
error.*

------------------------------------------------------------------------

## ğŸ’° Money Helpers

Convert between dollar amounts and integer cents for database storage.

> âš ï¸ **Why cents?** fastsql only supports `int` and `str` types â€”
> storing money as cents avoids floating-point precision issues.

<table>
<colgroup>
<col style="width: 34%" />
<col style="width: 37%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr>
<th>Function</th>
<th>Direction</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#to_cents"><code>to_cents</code></a></td>
<td><code>"$150.00"</code> â†’ <code>15000</code></td>
<td>Store in DB</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_sql.html#from_cents"><code>from_cents</code></a></td>
<td><code>15000</code> â†’ <code>"$150.00"</code></td>
<td>Display to user</td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L303"
target="_blank" style="float:right; font-size:smaller">source</a>

### to_cents

``` python

def to_cents(
    dollars:str | float | None
)->int | None:

```

*Convert dollar amount to integer cents for database storage.*

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_sql.py#L313"
target="_blank" style="float:right; font-size:smaller">source</a>

### from_cents

``` python

def from_cents(
    cents:int | None
)->str:

```

*Convert integer cents to formatted dollar string for display.*
