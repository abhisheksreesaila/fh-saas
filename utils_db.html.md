# üóÑÔ∏è Table Management


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## üéØ Overview

<table>
<colgroup>
<col style="width: 52%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_db.html#register_table"><code>register_table</code></a></td>
<td>Create table from dataclass model</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_db.html#register_tables"><code>register_tables</code></a></td>
<td>Create multiple tables atomically</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_db.html#drop_table"><code>drop_table</code></a></td>
<td>Drop table if exists</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_db.html#create_index"><code>create_index</code></a></td>
<td>Create index with dialect-specific SQL</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_db.html#drop_index"><code>drop_index</code></a></td>
<td>Drop index if exists</td>
</tr>
<tr>
<td><code>list_tables</code></td>
<td>List all tables in database</td>
</tr>
<tr>
<td><code>list_indexes</code></td>
<td>List indexes for a table</td>
</tr>
</tbody>
</table>

## üìã Table Registration

<table>
<colgroup>
<col style="width: 52%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_db.html#register_table"><code>register_table</code></a></td>
<td>Create single table from dataclass</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_db.html#register_tables"><code>register_tables</code></a></td>
<td>Create multiple tables atomically</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_db.html#drop_table"><code>drop_table</code></a></td>
<td>Drop table if exists</td>
</tr>
</tbody>
</table>

**Example:**

``` python
class Transaction:
    id: str
    amount: float
    date: str
    category: str = None

tenant_db = get_or_create_tenant_db("tenant_123")
transactions = register_table(tenant_db, Transaction, "transactions")

# Use table object for CRUD
transactions.insert(Transaction(id="t1", amount=100.0, date="2024-01-01"))
```

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_db.py#L21"
target="_blank" style="float:right; font-size:smaller">source</a>

### register_table

``` python

def register_table(
    tenant_db:Database, model_class:Type, table_name:str, pk:str='id'
):

```

*Create a table from a dataclass model if it doesn‚Äôt exist (atomic).*

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_db.py#L33"
target="_blank" style="float:right; font-size:smaller">source</a>

### register_tables

``` python

def register_tables(
    tenant_db:Database, models:List
)->Dict:

```

*Create multiple tables atomically (all succeed or all rollback).*

**Parameters:** - `models`: List of tuples
`[(ModelClass, table_name, pk), ...]`

**Returns:** Dict mapping table names to table objects
`{table_name: table_object}`

**Example:**

``` python
class Transaction:
    id: str; amount: float; date: str

class Connection:
    id: str; provider: str; status: str

tables = register_tables(tenant_db, [
    (Transaction, "transactions", "id"),
    (Connection, "connections", "id"),
])

tables["transactions"].insert(...)
```

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_db.py#L49"
target="_blank" style="float:right; font-size:smaller">source</a>

### drop_table

``` python

def drop_table(
    tenant_db:Database, table_name:str
)->None:

```

*Drop a table if it exists (atomic operation).*

## üìá Index Management

<table>
<colgroup>
<col style="width: 52%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_db.html#create_index"><code>create_index</code></a></td>
<td>Create index with dialect-specific SQL</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_db.html#create_indexes"><code>create_indexes</code></a></td>
<td>Create multiple indexes atomically</td>
</tr>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_db.html#drop_index"><code>drop_index</code></a></td>
<td>Drop index if exists</td>
</tr>
</tbody>
</table>

**Parameters for
[`create_index`](https://abhisheksreesaila.github.io/fh-saas/utils_db.html#create_index):**

<table>
<colgroup>
<col style="width: 45%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table_name</code></td>
<td>Name of the table</td>
</tr>
<tr>
<td><code>columns</code></td>
<td>List of column names to index</td>
</tr>
<tr>
<td><code>unique</code></td>
<td>If True, creates UNIQUE index (default: False)</td>
</tr>
<tr>
<td><code>index_name</code></td>
<td>Custom name (auto-generates <code>idx_{table}_{cols}</code> if
None)</td>
</tr>
</tbody>
</table>

**Example:**

``` python
# Simple index
create_index(tenant_db, "transactions", ["date"])

# Composite unique index
create_index(tenant_db, "transactions", ["account_id", "external_id"], unique=True)

# Custom name
create_index(tenant_db, "transactions", ["category"], index_name="idx_txn_cat")
```

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_db.py#L61"
target="_blank" style="float:right; font-size:smaller">source</a>

### create_index

``` python

def create_index(
    tenant_db:Database, table_name:str, columns:List, unique:bool=False, index_name:str=None
)->None:

```

*Create an index on a table if it doesn‚Äôt exist (atomic operation).*

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_db.py#L83"
target="_blank" style="float:right; font-size:smaller">source</a>

### create_indexes

``` python

def create_indexes(
    tenant_db:Database, indexes:List
)->None:

```

*Create multiple indexes atomically (all succeed or all rollback).*

**Parameters:** - `indexes`: List of tuples
`[(table_name, columns, unique, index_name), ...]` - `index_name` can be
`None` for auto-generated names

**Example:**

``` python
create_indexes(tenant_db, [
    ("transactions", ["date"], False, None),
    ("transactions", ["account_id", "external_id"], True, "idx_txn_unique"),
    ("connections", ["provider"], False, None),
])
```

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_db.py#L107"
target="_blank" style="float:right; font-size:smaller">source</a>

### drop_index

``` python

def drop_index(
    tenant_db:Database, index_name:str, table_name:str=None
)->None:

```

*Drop an index if it exists (atomic operation).*

## üîç Schema Introspection

<table>
<colgroup>
<col style="width: 52%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><a
href="https://abhisheksreesaila.github.io/fh-saas/utils_db.html#table_exists"><code>table_exists</code></a></td>
<td>Check if a table exists</td>
</tr>
</tbody>
</table>

**Example:**

``` python
if not table_exists(tenant_db, "transactions"):
    transactions = register_table(tenant_db, Transaction, "transactions")
```

------------------------------------------------------------------------

<a
href="https://github.com/abhisheksreesaila/fh-saas/blob/main/fh_saas/utils_db.py#L127"
target="_blank" style="float:right; font-size:smaller">source</a>

### table_exists

``` python

def table_exists(
    tenant_db:Database, table_name:str
)->bool:

```

*Check if a table exists in the database.*

## Usage Example

Complete workflow: Define dataclass models ‚Üí Get tenant DB ‚Üí Register
tables ‚Üí Create indexes
